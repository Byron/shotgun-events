

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Technical Overview &mdash; Shotgun Events Daemon v0.9 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Shotgun Events Daemon v0.9 documentation" href="index.html" />
    <link rel="next" title="Plugin API" href="api.html" />
    <link rel="prev" title="Welcome to Shotgun Event Daemon’s documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="api.html" title="Plugin API"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Shotgun Event Daemon’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Shotgun Events Daemon v0.9 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="technical-overview">
<h1>Technical Overview<a class="headerlink" href="#technical-overview" title="Permalink to this headline">¶</a></h1>
<div class="section" id="plugin-processing-order">
<h2>Plugin processing order<a class="headerlink" href="#plugin-processing-order" title="Permalink to this headline">¶</a></h2>
<p>Each event is always processed in the same predictable order so if any plugins
or callbacks are co-dependant, your can safely organize their processing.</p>
<p>The configuration file specifies a <em>paths</em> config that contains one or multiple
plugin locations. The earlier the location in the list the earlier the contained
plugins will be processed.</p>
<p>Each plugin within a plugin path is then processed in ascending alphabetical order.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Internally the filenames are put in a list and sorted.</p>
</div>
<p>Finally, each callback registered by a plugin is called in registration order.
First resgistered, first run.</p>
<p>It is suggested to keep any functionality that needs to share state somehow in
the same plugin as one or multiple callbacks.</p>
</div>
<div class="section" id="registering-a-plugin">
<h2>Registering a plugin<a class="headerlink" href="#registering-a-plugin" title="Permalink to this headline">¶</a></h2>
<p>When the daemon loads, it looks in defined plugin locations and tries to import
any .py file. If a .py file has a <em>registerCallbacks</em> function, it is called,
passing in a Registrar object. The Registrar is what is used to do the callback
registrations.</p>
<p>Here is an example of a <em>registerCallbacks</em> function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">registerCallbacks</span><span class="p">(</span><span class="n">reg</span><span class="p">):</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">registerCallback</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="s">&#39;apiKey&#39;</span><span class="p">,</span> <span class="n">doEvent</span><span class="p">)</span>
</pre></div>
</div>
<p>The registerCallback method of the Registrar object requires three arguments:</p>
<ul class="simple">
<li>A script name (as per Shotgun)</li>
<li>A script API key (as per Shotgun)</li>
<li>A callback to provide events to for processing</li>
</ul>
<p>Optionally, you can also provide an argument that will be passed on to the
processing callback.</p>
</div>
<div class="section" id="a-callback">
<h2>A callback<a class="headerlink" href="#a-callback" title="Permalink to this headline">¶</a></h2>
<p>A callback requires four arguments:</p>
<ul class="simple">
<li>A shotgun instance with which to fetch any required information</li>
<li>A logger object used to log messages.</li>
<li>The event to process</li>
<li>Any extra arguments provided at registration time</li>
</ul>
<p>Here is an example of a functional callback:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">doEvent</span><span class="p">(</span><span class="n">sg</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;In event </span><span class="si">%s</span><span class="s">...&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">event</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="logging-information">
<h2>Logging information<a class="headerlink" href="#logging-information" title="Permalink to this headline">¶</a></h2>
<p>All information can be passed out of the system (framework or plugins) by using
the provided logger objects that come from the Python logging framework and are
configured appropriately for you.</p>
<p>To log from the registerCallbacks function do as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">registerCallbacks</span><span class="p">(</span><span class="n">reg</span><span class="p">):</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;info&#39;</span><span class="p">)</span>
    <span class="n">reg</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s">&#39;error&#39;</span><span class="p">)</span> <span class="c"># levels error and higher will be sent via email.</span>
</pre></div>
</div>
<p>To log from a callback function:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">myRegisteredCallback</span><span class="p">(</span><span class="n">sg</span><span class="p">,</span> <span class="n">logger</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&#39;In callback...&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Technical Overview</a><ul>
<li><a class="reference internal" href="#plugin-processing-order">Plugin processing order</a></li>
<li><a class="reference internal" href="#registering-a-plugin">Registering a plugin</a></li>
<li><a class="reference internal" href="#a-callback">A callback</a></li>
<li><a class="reference internal" href="#logging-information">Logging information</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to Shotgun Event Daemon&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="api.html"
                        title="next chapter">Plugin API</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/techOverview.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="api.html" title="Plugin API"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Shotgun Event Daemon’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">Shotgun Events Daemon v0.9 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Patrick Boucher.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.6.
    </div>
  </body>
</html>